{% extends 'base.html' %}
{% load static %}

{% block title %}
<title>Realive</title>
{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/statistics.css' %}">
{% endblock %}

{% block content %}
<div class="container-fluid mainArea">
    <div class="row">
        <div class="col-1"></div>
        <div class="col-7 nopadding">
            <iframe id="player" width="100%">
            </iframe>
        </div>
        <div class="col-3 nopadding playerlist_container">
            <p class="listHeader">直播影片紀錄</p>
            <ul class="playlist"></ul>
            <form id="vidForm" method="post" action="">
                {% csrf_token %}
                <input id="vidInput" type="hidden" name="vid">
            </form>
        </div>
        <div class="col-1"></div>
    </div>
    <div class="row">
        <div class="col-1"></div>
        <div class="col-4 col-sm-2 col-md-2">
            <label id="emotionLabel" style="visibility: hidden;">情緒反應:</label>
            <form>
                <select id="emotionSelect" name="emotion" style="visibility: hidden;">
                    <option value="Angry">生氣</option>
                    <option value="Disgust">困惑</option>
                    <option value="Fear">害怕</option>
                    <option value="Happy">開心</option>
                    <option value="Sad">難過</option>
                    <option value="Surprise">驚訝</option>
                    <option value="Neutral">其他</option>
                </select>
            </form>
        </div>
        <div class="col-4 col-sm-2 col-md-2">
            <label id="timeLabel" style="visibility: hidden;">時間單位:</label>
            <form>
                <select id="timeSelect" name="timeline" style="visibility: hidden;">
                    <option value="second">秒</option>
                    <option value="minute" selected>分</option>
                    <option value="hour">小時</option>
                </select>
            </form>
        </div>
    </div>
    <div class="row">
        <div class="col-1"></div>
        <div class="col-10 canvasRoom">
            <canvas id="myChart"></canvas>
        </div>
        <div class="col-1"></div>
    </div>
</div>
{% endblock %}

{% block js %}
<script src="{% static 'js/Chart.min.js' %}"></script>
<script src="{% static 'js/statistics.js' %}"></script>

<script type="text/javascript">
    {% if not request.user.is_authenticated %}
    alert("請先登錄");
    {% endif %}

    {% for video in videos %}
    uploadVideo("{{ video.vid }}");
    {% endfor %}

    {% if vid != None %}
    document.getElementById('emotionLabel').style.visibility = 'visible';
    document.getElementById('emotionSelect').style.visibility = 'visible';
    document.getElementById('timeLabel').style.visibility = 'visible';
    document.getElementById('timeSelect').style.visibility = 'visible';
    playVideo("{{ vid }}");
    createChart([], []);
    {% endif %}
</script>
{% endblock %}
